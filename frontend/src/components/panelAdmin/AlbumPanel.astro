---
export interface Props {
    base?: string;
    baseCrear?: string;
    baseEditar?: string;
    baseEliminar?: string;
}

const { base = "/api/admin/album" } = Astro.props;

const {
    baseCrear = "/api/admin/album",
    baseEditar = "/api/admin/album",
    baseEliminar = "/api/admin/album",
} = Astro.props;

const uid = "albumes-" + Math.random().toString(36).slice(2);
---

<section
    id={uid}
    data-uid={uid}
    data-album-panel
    data-base-crear={baseCrear}
    data-base-editar={baseEditar}
    data-base-eliminar={baseEliminar}
    data-albums="/api/public/album"
    data-artistas="/api/public/artistas"
    class="w-full min-h-[60vh] flex items-center justify-center px-4 sm:px-6 md:px-10 py-10"
>
    <!-- Tarjeta -->
    <div
        class="w-full min-h-[50vh] max-w-5xl rounded-2xl border border-gray-700
               bg-gradient-to-b from-gray-900/70 to-gray-800/80
               shadow-[0_0_40px_rgba(255,0,0,0.18)] backdrop-blur-sm
               p-8 md:p-12 space-y-10"
        style="padding-top: 20px;"
    >
        <!-- Titulo -->
        <div class="relative flex justify-center mb-4">
            <h1
                class="text-white text-3xl md:text-5xl tracking-wide font-maximum text-center"
            >
                ALBUMES
            </h1>
        </div>

        <div class="h-14 md:h-14"></div>

        <!-- Tabs -->
        <div
            class="flex flex-wrap justify-center gap-6 md:gap-8 mb-6 pb-4 border-b border-gray-700/60"
        >
            <button
                data-tab="crear"
                type="button"
                class="tab min-w-[140px] px-6 py-3 rounded-full border text-base md:text-lg
                       bg-gray-800/70 text-white/80 border-gray-700 shadow-md
                       hover:bg-gray-700 hover:text-white hover:scale-105 cursor-pointer"
            >
                Crear
            </button>
            <button
                data-tab="editar"
                type="button"
                class="tab min-w-[140px] px-6 py-3 rounded-full border text-base md:text-lg
                       bg-gray-800/70 text-white/80 border-gray-700 shadow-md
                       hover:bg-gray-700 hover:text-white hover:scale-105 cursor-pointer"
            >
                Editar
            </button>
            <button
                data-tab="eliminar"
                type="button"
                class="tab min-w-[140px] px-6 py-3 rounded-full border text-base md:text-lg
                       bg-gray-800/70 text-white/80 border-gray-700 shadow-md
                       hover:bg-gray-700 hover:text-white hover:scale-105 cursor-pointer"
            >
                Eliminar
            </button>
        </div>

        <div class="h-14 md:h-14"></div>

        <!-- PANEL CREAR -->
        <div data-panel="crear" class="block mt-2">
            <form
                data-form="crear"
                class="space-y-6 bg-gray-800/60 p-6 md:p-8 rounded-xl border border-white/10"
                style="margin-left: 10px; margin-right: 10px; margin-bottom: 10px;"
            >
                <div
                    class="grid md:grid-cols-2 gap-6"
                    style="margin-left: 10px; margin-right: 10px; margin-top: 10px"
                >
                    <!-- Columna izquierda -->
                    <div class="space-y-4">
                        <div class="flex flex-col gap-2">
                            <label class="block text-sm text-gray-300">
                                Titulo *
                            </label>
                            <input
                                name="titulo"
                                class="w-full rounded-xl px-4 py-3 bg-gray-900/70 text-white
                                       border border-white/10 focus:outline-none
                                       focus:ring-2 focus:ring-red-500/40 focus:border-red-400"
                            />
                            <p
                                data-error="titulo"
                                class="text-xs text-red-400 mt-1"
                            >
                            </p>
                        </div>

                        <div class="flex flex-col gap-2">
                            <label class="block text-sm text-gray-300">
                                Descripcion (max 255)
                            </label>
                            <textarea
                                name="descripcion"
                                rows={4}
                                maxlength="255"
                                class="w-full rounded-xl px-4 py-3 bg-gray-900/70 text-white
                                       border border-white/10 focus:outline-none
                                       focus:ring-2 focus:ring-red-500/40 focus:border-red-400 resize-y"
                            ></textarea>
                            <p
                                data-error="descripcion"
                                class="text-xs text-red-400 mt-1"
                            >
                            </p>
                        </div>
                    </div>

                    <!-- Columna derecha -->
                    <div class="space-y-4">
                        <div class="flex flex-col gap-2">
                            <label class="block text-sm text-gray-300">
                                Artista *
                            </label>
                            <select
                                id="select-artista-album-crear"
                                data-select-artista="crear"
                                name="artistaId"
                                class="select2 w-full rounded-xl px-4 py-3 bg-gray-900/70 text-white
                                       border border-white/10 focus:outline-none
                                       focus:ring-2 focus:ring-red-500/40 focus:border-red-400"
                            >
                                <option value="">Selecciona un artista</option>
                            </select>
                            <p
                                data-error="artistaId"
                                class="text-xs text-red-400 mt-1"
                            >
                            </p>
                        </div>
                        <div class="flex flex-col gap-2">
                            <label
                                class="block text-sm text-gray-300"
                                for={`portada-album-crear-${uid}`}
                            >
                                Portada (Imagen)
                            </label>
                            <input
                                id={`portada-album-crear-${uid}`}
                                type="file"
                                accept="image/*"
                                name="portada"
                                class="w-full rounded-xl px-4 py-3 bg-gray-900/70 text-white
                                       border border-white/10 focus:outline-none
                                       focus:ring-2 focus:ring-red-500/40 focus:border-red-400"
                                data-portada
                            />
                            <p
                                data-preview-portada
                                class="text-xs text-gray-400 mt-1"
                            >
                            </p>
                        </div>
                    </div>
                </div>

                <div class="h-10 md:h-10"></div>

                <div
                    class="flex justify-center items-center pt-4"
                    style="padding-bottom: 10px;"
                >
                    <button
                        class="px-6 py-3 rounded-xl bg-red-500 text-white font-medium
                               hover:bg-red-600 active:scale-[.98] hover:scale-105
                               transition cursor-pointer"
                        style="
                        padding-left: 40px;
                        padding-right: 40px;"
                    >
                        Crear album
                    </button>
                </div>

                <p
                    data-msg="crear"
                    class="text-sm text-gray-300 mt-2 text-center"
                >
                </p>
            </form>
        </div>

        <!-- PANEL EDITAR -->
        <div data-panel="editar" class="hidden mt-2">
            <form
                data-form="editar"
                class="space-y-6 bg-gray-800/60 p-6 md:p-8 rounded-xl border border-white/10"
                style="margin-left: 10px; margin-right: 10px; margin-bottom: 10px;"
            >
                <!-- Seleccionar album -->
                <div
                    class="flex flex-col gap-3"
                    style="margin-left: 10px; margin-right: 10px; margin-top: 10px"
                >
                    <label class="block text-sm text-gray-300">
                        Selecciona un album *
                    </label>
                    <select
                        id="select-album-editar"
                        name="albumId"
                        data-select-album="editar"
                        class="select2 w-full rounded-xl px-4 py-3 bg-gray-900/70 text-white
                               border border-white/10 focus:outline-none
                               focus:ring-2 focus:ring-red-500/40 focus:border-red-400"
                    >
                        <option value="">Selecciona un album</option>
                    </select>
                    <p data-error="albumId" class="text-xs text-red-400 mt-1">
                    </p>
                </div>

                <div
                    class="grid md:grid-cols-2 gap-6 pt-2"
                    style="margin-left: 10px; margin-right: 10px; margin-top: 10px"
                >
                    <!-- Columna izquierda -->
                    <div class="space-y-4">
                        <div class="flex flex-col gap-2">
                            <label class="text-sm text-gray-300">
                                Nuevo titulo
                            </label>
                            <input
                                name="titulo"
                                class="w-full rounded-xl px-4 py-3 bg-gray-900/70 text-white
                                       border border-white/10 focus:outline-none
                                       focus:ring-2 focus:ring-red-500/40 focus:border-red-400"
                            />
                        </div>

                        <div class="flex flex-col gap-2">
                            <label class="text-sm text-gray-300">
                                Nueva descripcion (max 255)
                            </label>
                            <textarea
                                name="descripcion"
                                rows={4}
                                maxlength="255"
                                class="w-full rounded-xl px-4 py-3 bg-gray-900/70 text-white
                                       border border-white/10 focus:outline-none
                                       focus:ring-2 focus:ring-red-500/40 focus:border-red-400 resize-y"
                            ></textarea>
                            <p
                                data-error="descripcion"
                                class="text-xs text-red-400 mt-1"
                            >
                            </p>
                        </div>
                    </div>

                    <!-- Columna derecha -->
                    <div class="space-y-4">
                        <div class="flex flex-col gap-2">
                            <label class="text-sm text-gray-300">
                                Cambiar artista *
                            </label>
                            <select
                                id="select-artista-album-editar"
                                data-select-artista="editar"
                                name="artistaId"
                                class="select2 w-full rounded-xl px-4 py-3 bg-gray-900/70 text-white
                                       border border-white/10 focus:outline-none
                                       focus:ring-2 focus:ring-red-500/40 focus:border-red-400"
                            >
                                <option value=""></option>
                            </select>
                            <p
                                data-error="artistaId"
                                class="text-xs text-red-400 mt-1"
                            >
                            </p>
                        </div>
                        <div class="flex flex-col gap-2">
                            <label
                                class="text-sm text-gray-300"
                                for={`portada-album-editar-${uid}`}
                            >
                                Nueva portada (opcional)
                            </label>
                            <input
                                id={`portada-album-editar-${uid}`}
                                type="file"
                                name="portada"
                                accept="image/*"
                                class="w-full rounded-xl px-4 py-3 bg-gray-900/70 text-white
                                       border border-white/10 focus:outline-none
                                       focus:ring-2 focus:ring-red-500/40 focus:border-red-400"
                                data-portada
                            />
                            <p
                                data-preview-portada-editar
                                class="text-xs text-gray-400 mt-1"
                            >
                            </p>
                        </div>
                    </div>
                </div>

                <div class="h-10 md:h-10"></div>

                <div
                    class="flex justify-center items-center pt-4"
                    style="padding-bottom: 10px;"
                >
                    <button
                        class="px-6 py-3 rounded-xl bg-green-600 text-white font-medium
                               hover:bg-green-500 active:scale-[.98] transition cursor-pointer hover:scale-105"
                        style="
                        padding-left: 40px;
                        padding-right: 40px;"
                    >
                        Guardar cambios
                    </button>
                </div>

                <p
                    data-msg="editar"
                    class="text-sm text-gray-300 mt-2 text-center"
                >
                </p>
            </form>
        </div>

        <!-- PANEL ELIMINAR -->
        <div data-panel="eliminar" data-delete-type="album" class="hidden mt-2">
            <form
                data-form="eliminar"
                class="space-y-6 bg-gray-800/60 p-6 md:p-8 rounded-xl border border-white/10"
                style="margin-left: 10px; margin-right: 10px;"
            >
                <div
                    class="flex flex-col gap-3"
                    style="margin-left: 10px; margin-right: 10px; margin-top: 10px"
                >
                    <label class="block text-sm text-gray-300">
                        Selecciona un album
                    </label>
                    <select
                        id="select-album-eliminar"
                        name="eliminar"
                        data-select-album="eliminar"
                        data-delete-select
                        class="select2 w-full rounded-xl px-4 py-3 bg-gray-900/70 text-white
                               border border-white/10 focus:outline-none
                               focus:ring-2 focus:ring-red-500/40 focus:border-red-400"
                    >
                        <option value="">Selecciona un album</option>
                    </select>
                    <p data-error="eliminar" class="text-xs text-red-400 mt-1">
                    </p>
                </div>

                <div class="h-10 md:h-10"></div>

                <div
                    class="flex justify-center items-center pt-6"
                    style="padding-bottom: 10px;"
                >
                    <button
                        type="button"
                        data-delete-trigger
                        class="px-6 py-3 rounded-xl bg-red-600 text-white font-medium
                               hover:bg-red-500 active:scale-[.98] transition cursor-pointer hover:scale-105"
                        style="
                        padding-left: 40px;
                        padding-right: 40px;"
                    >
                        Eliminar album
                    </button>
                </div>

                <p
                    data-msg="eliminar"
                    class="text-sm text-gray-300 mt-2 text-center"
                >
                </p>
            </form>
        </div>
    </div>

    <script type="module" src="/scripts/admin/IndicadorInput.js"></script>
    <script type="module" src="/scripts/admin/adminAlbum.js"></script>
    <script type="module" src="/scripts/admin/SelectsGlobal.js"></script>

    <style is:global>
        .tab {
            transition: all 0.3s ease;
        }
        .tab.active {
            background: rgba(220, 38, 38, 0.8) !important;
            color: #fff !important;
            border-color: rgb(239 68 68);
            transform: scale(1.05);
            box-shadow: 0 0 20px rgba(255, 0, 0, 0.3);
        }
    </style>
</section>
